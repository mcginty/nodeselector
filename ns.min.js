/* 
nodeSelector
Originally by Paul Tarjan (http://paultarjan.com/)
Modified by Jake McGinty (http://jakemcginty.com/)
*/

if(typeof nodeselector=="undefined"){nodeselector={};}if(typeof nodeselector.ns=="undefined"){nodeselector.ns={};}if(typeof nodeselector.ns.addLibs=="undefined"){if(typeof nodeselector.ns.caseSensitive=="undefined"){nodeselector.ns.caseSensitive=false;}nodeselector.ns.addLibs=function(){var node=document.createElement("script");node.src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js";document.body.appendChild(node);nodeselector.ns.nodeSelector();};nodeselector.ns.nodeSelector=function(){if(window.console===undefined){window.console={log:function(){}};}var mouseover=function(ev){if(ev.target!=this){return true;}ev.stopPropagation();var e=$(ev.target);e.data("saved",{"outline-width":e.css("outline-width"),"outline-color":e.css("outline-color"),"outline-style":e.css("outline-style")});e.css("outline","3px solid rgba(255,0,0, 0.7)");};var mouseout=function(ev){if(ev.target!=this){return true;}ev.stopPropagation();var e=$(ev.target);save=e.data("saved");if(typeof(save)=="undefined"){return;}e.removeData("saved");for(var i in save){console.log("restored: "+i+", "+save[i]);e.css(i,save[i]);}};var click=function(ev){if(ev.target!=this){return true;}ev.preventDefault();ev.stopPropagation();var e=$(ev.target);var xpath=getXpath(ev.target);console.log(xpath);if(typeof(nodeselector.ns.doneURL)!="undefined"){if(nodeselector.ns.doneURL.indexOf("?")==-1){nodeselector.ns.doneURL+="?";}else{nodeselector.ns.doneURL+="&";}var params={"xpath":xpath,"referer":window.location.href};if(typeof nodeselector.ns.params!="undefined"){params['params']=nodeselector.ns.params;}var url=$.param(params);url=nodeselector.ns.doneURL+url;console.log(url);window.location=url;return false;}var node=$("#hover");if(node.size()===0){$(document.body).append("<div id='hover'></div>");node=$("#hover");node.css({"position":"absolute","display":"inline","border":"1px solid black","backgroundColor":"white","padding":"2px","width":"auto","z-index":"255"}).fadeOut(0).click(function(ev){ev.stopPropagation();});}node.html(xpath);node.animate({"top":(e.offset().top)+"px","left":(e.offset().left)+"px"},250).fadeIn(250);};$("*").each(function(){$(this).mouseover(mouseover).mouseout(mouseout).click(click);});function getXpath(e){var xpath="";var oldE=e;while(e.nodeName.toLowerCase()!="html"){var node=e.nodeName;if(nodeselector.ns.caseSensitive===false){node=node.toLowerCase();}var id=e.id;if(id!==undefined&&id!==null&&id!==""){xpath="//"+node+"[@id='"+id+"']"+xpath;break;}var parent=e.parentNode;var children=$(parent).children(node);if(children.size()>1){var good=false;children.each(function(i){if(this==e){node=node+"["+(i+1)+"]";good=true;return false;}});if(!good){console.log("Can't find child, something is wrong with your dom : "+node);return FALSE;}}xpath="/"+node+xpath;e=parent;}if(xpath.substring(0,2)!="//"){xpath="/html"+xpath;}if(typeof nodeselector.ns.getXpath=="function"){xpath=nodeselector.ns.getXpath(oldE,xpath);}return xpath;}};$(document).ready(function(){nodeselector.ns.addLibs();});}